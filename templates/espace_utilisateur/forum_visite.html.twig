{% extends 'base.html.twig' %}

{% block title %}Liste des sujets{% endblock %}

{% block body %}
    <script src="https://bootswatch.com/_vendor/jquery/dist/jquery.min.js"></script>
    <script>
        function gestionTexte(element, fleche){
			var  elementF = document.getElementById(element);
			var flecheF = document.getElementById(fleche);
			if (elementF.style.display == "none"){
				elementF.style.display = "block";
				flecheF.innerHTML = "▲";
			}
			else {
				elementF.style.display = "none";
				flecheF.innerHTML = "▼";
			}
		}
    </script>
    <div class="card bg-light mb-3 float-left" style="max-width: 20rem;">
        <div class="card-header">Tableau de bord de {{ app.user.username }}</div>
            <div class="card-body">
                <h4 class="card-title">Table des matières</h4>
                <p class="card-text">
                    <ul>
                        <li>Produits <i id="flecheF1" onclick="gestionTexte('element1', 'flecheF1')" style="cursor:pointer;">▼</i>
                            <div id="element1" style="display:none">
                                <ul>
                                    <li><a class="text-secondary"href="{{ path("produit_visite") }}">Les produits visités</a></li>
                                    <li><a class="text-secondary"href="{{ path("produit_notes") }}">Les produits notés</a></li>
                                    <li><a class="text-secondary"href="{{ path("produit_commentaires") }}">Les produits commentés</a></li>
                                </ul>
                            </div>
                        </li>
                        <li>Forum <i id="flecheF2" onclick="gestionTexte('element2', 'flecheF2')" style="cursor:pointer;">▼</i>
                            <div id="element2" style="display:block">
                                <ul>
                                    <li><a class="text-succes"href="#">Les sujets visités</a></li>
                                    <li><a class="text-secondary"href="{{ path("forum_discussion") }}">Mes sujets</a></li>
                                    <li><a class="text-secondary"href="{{ path("forum_participation") }}">Participations aux sujets</a></li>
                                </ul>
                            </div>
                        </li>
                        <li>Amis <i id="flecheF3" onclick="gestionTexte('element3', 'flecheF3')" style="cursor:pointer;">▼</i>
                            <div id="element3" style="display:none">
                                <ul>
                                    <li><a class="text-secondary"href="{{ path("liste_utilisateur") }}">Liste des utilisateurs</a></li>
                                    <li><a class="text-secondary"href="{{ path("liste_amis") }}">Liste d'amis</a></li>
                                    <li><a class="text-secondary"href="{{ path("demandes") }}">Demandes en attentes</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </p>
            </div>
        </div>
    </div>
    <div class="container">
        {% if sujetsVisite is defined %}
            <div class="form-group mx-auto">
                <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal">Supprimer l'historique <i class="fas fa-trash-alt"></i></button>
            </div>
            <div class="modal" id="myModal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><i class="fa fa-exclamation-circle text-danger"></i> Suppression de l'historique</h5>
                        </div>
                        <div class="modal-body">
                            <p>Etes-vous sûr de vouloir supprimer votre historique ?</p>
                        </div>
                        <div class="modal-footer">
                            <form action="{{ path("forum_visite_supprimer") }}">
                                <button type="submit" class="btn btn-primary">Oui <i class="fa fa-check"></i></button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Non <i class="fa fa-times"></i></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <table class="table table-sm table-striped table-hover mt-5 mx-auto" style="width: 70%">
                <thead class="thead-light">
                    <tr>
                        <th class="w-75">Titre</th>
                        <th>Utilisateur</th>
                        <th>Date</th>
                    </tr>
                </thead>
                
                <tbody>
                
                    {% for s in sujetsVisite %}
                    <tr>
                        <td class="font-weight-bold"> <a href="{{ path("readDisc", {"id": s.idDiscussion}) }}">{{ s.titre }}</a> </td>
                        <td> {{ s.id_utilisateur.username }} </td>
                        <td class="text-muted"> {{ s.creation | date("d/m/Y") }} </td>
                    </tr>
                    {% endfor %}
                
                </tbody>
            </table>

            <div class="mt-3">{{ knp_pagination_render(sujetsVisite) }}</div>
        {% else %} 
            <h1>Aucun Sujet</h1>
        {% endif %}
    </div>
    {% for message in app.flashes('succes') %}
        <div class="alert alert-dismissible alert-success fixed-bottom ml-auto" style="width: 300px; heigth: 200px; margin-bottom: 65px;">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <strong>{{ message }}</strong>
        </div>
    {% endfor %}
{% endblock %}
